<Project>
    <PropertyGroup>
        <ClrHeapAllocationAnalyzerConfigurationOutputPath>$(MSBuildProjectDirectory)</ClrHeapAllocationAnalyzerConfigurationOutputPath>
        <ClrHeapAllocationAnalyzerConfigurationBinary>$(PkgClrHeapAllocationAnalyzer_Configuration)/bin/ClrHeapAllocationAnalyzer.Configuration.exe</ClrHeapAllocationAnalyzerConfigurationBinary>
    </PropertyGroup>

    <Target Name="GenerateAnalyzerConfiguration"
            BeforeTargets="CoreCompile"
            Condition="'$(IsRunningClrHeapAllocationAnalyzerConfiguration)' == ''"
            Inputs="@(Compile)"
            Outputs="$(ClrHeapAllocationAnalyzerConfigurationOutputPath)/whitelist.txt">
            <Exec Command="$(ClrHeapAllocationAnalyzerConfigurationBinary) $(ClrHeapAllocationAnalyzerConfigurationOutputPath)" />
    </Target>

</Project>